<!DOCTYPE html>
<html lang="en">

<head> 
       <title> client WebSocket </title> 
       <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
       <script src="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.3/js/tabulator.min.js"></script>
       <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tabulator/3.5.3/css/tabulator.min.css"></link>

    <script type="text/javascript">
    
    const socket = new WebSocket('ws://localhost:8080/chat'); //sever address URl 
    
    
        socket.addEventListener('open',function(event){
    
            // send message kode 
            socket.send('Hello server');
        });
    
    
        socket.addEventListener('message',function(message){
    
        // wait for message
        document.getElementById("wsupdate").innerHTML = message.data

        });

        function getData()
  {
      axios.get('http://localhost:8080')
      .then((response) => {
          setTable(response.data);
      });
  }

  function getDataThree() {
      axios.get('http://localhost:8080/three')
      .then(response => {
      setTable(response.data);
      }).catch(error => alert('Try again'));
  }

  function getDataByDate() {
      axios.get('http://localhost:8080/date/'+document.getElementById("Date").value)
      .then(response => {
      setTable(response.data);
      }).catch(error => alert('Try again'));
  }
  function getDataByID() {
      axios.get('http://localhost:8080/id/'+document.getElementById("ID").value)
      .then(response => {
      setTable(response.data);
      }).catch(error => alert('Try again'));
  }

  function postData()
  {
      axios.post('http://localhost:8080/',
      {
          "ID":document.getElementById("ID").value,
          "Date":document.getElementById("Date").value,
          "Time":document.getElementById("Time").value,
          "Place": 
          {
              "PlaceName":document.getElementById("PlaceName").value, 
              "Lat":Number(document.getElementById("Lat").value), 
              "Lon":Number(document.getElementById("Lon").value)
          },
          "Temperature":Number(document.getElementById("Temperature").value),
          "Humidity":Number(document.getElementById("Humidity").value)
      })
      .then(response => {}).catch(error => alert('try again')); 

      print("test");
      console.log("Hej");
    }

    function putById()
    {

      axios.put('http://localhost:8080/id/'+ document.getElementById("ID").value,
      {
          
          "ID": document.getElementById("ID").value,
          "Date": document.getElementById("Date").value,
          "Time": document.getElementById("Time").value,
          "Place": 
          {
              "PlaceName": document.getElementById("PlaceName").value, 
              "Lat":Number(document.getElementById("Lat").value), 
              "Lon":Number(document.getElementById("Lon").value)
          },
          "Temperature":Number(document.getElementById("Temperature").value),
          "Humidity":Number(document.getElementById("Humidity").value)
      })
      .then(response => {}).catch(error => alert('try again')); 
       console.log("Hej");
    }
    
    
        function setTable(data){
            
            $("#table").tabulator({
                layout: "fitDataFill",
                height: "311px",
                columns: [

                {
                    title: "ID",
                    field: "ID"
                },
                {
                    title: "Date",
                    field: "Date"
                },
                {
                    title: "Time",
                    field: "Time"
                },
                {
                    title: "Place",
                    field: "Place.PlaceName"
                },
                {
                    title: "Lat",
                    field: "Place.Lat"
                },
                {
                    title: "Lon",
                    field: "Place.Lon"
                },
                {
                    title: "Temperature",
                    field: "Temperature"
                },
                {
                    title: "Humidity",
                    field: "Humidity"
                }

                ],

            });
            
            $("#table").tabulator("setData", data);
    
        }
    
    </script> 
</head> 

<body>

<h2>The Weather station</h2>

<p>Input data here</p>

<form>
<label for ="ID">ID:</label><br>
<input type = "text" id = "ID" name = "ID"><br><br>

<label for ="Date">Date:</label><br>
<input type = "text" id = "Date" name = "Date"><br><br>

<label for ="Time">Time:</label><br>
<input type = "text" id = "Time" name = "Time"><br><br>

<label for ="PlaceName">PlaceName:</label><br>
<input type = "text" id = "PlaceName" name = "PlaceName"><br><br>

<label for ="Lat">Lat:</label><br>
<input type = "text" id = "Lat" name = "Lat"><br><br>

<label for ="Lon">Lon:</label><br>
<input type = "text" id = "Lon" name = "Lon"><br><br>

<label for ="Temperature">Temperature:</label><br>
<input type = "text" id = "Temperature" name = "Temperature"><br><br> 

<label for ="Humidity">Humidity:</label><br>
<input type = "text" id = "Humidity" name = "Humidity"><br><br>


<input type="submit" value="Post Data" onclick="postData()">
</form>


<br>
<input type="button" value="Hent data" onclick="getData()">
<input type="button" value="Hent seneste 3 data" onclick="getDataThree()">
<input type="button" value="Hent for dato" onclick="getDataByDate()">
<input type="button" value="Hent for ID" onclick="getDataByID()">
<input type="button" value="Ã†ndre med ID" onclick="putById()">




<br>
<div id="table">
</div>
    
<div id="wsupdate">
</div>

</body>
</html>



















